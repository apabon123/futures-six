# Strategy Configuration
# Deterministic parameters for each agent in the futures-six system

tsmom:
  lookbacks: [252]
  skip_recent: 21
  standardize: "vol"
  signal_cap: 3.0
  rebalance: "W-FRI"

vol_overlay:
  target_vol: 0.20
  lookback_vol: 63
  leverage_mode: "global"
  cap_leverage: 7.0
  position_bounds: [-3.0, 3.0]

risk_vol:
  cov_lookback: 252
  vol_lookback: 63
  shrinkage: "lw"
  nan_policy: "mask-asset"

allocator:
  method: "signal-beta"
  gross_cap: 7.0
  net_cap: 2.0
  w_bounds_per_asset: [-1.5, 1.5]
  turnover_cap: 0.5
  lambda_turnover: 0.001

# =============================================================================
# RISK TARGETING LAYER (Layer 5 in Canonical Stack)
# =============================================================================
# Purpose: Define how large the portfolio is by design
# Key Principle: Encodes risk appetite, not risk control
# This layer is ALWAYS ON and UPSTREAM of the allocator
risk_targeting:
  enabled: true               # Master switch for Risk Targeting layer
  target_vol: 0.20            # Target annualized portfolio volatility (20%)
  vol_lookback: 63            # Rolling window for vol estimation (days)
  leverage_cap: 7.0           # Maximum leverage allowed
  leverage_floor: 1.0         # Minimum leverage (no deleveraging below 1x)
  vol_floor: 0.05             # Minimum vol estimate to avoid extreme scaling
  update_frequency: "static"  # How often target_vol can change: "static", "quarterly", "monthly"
  # Note: Risk Targeting answers "How big do I trade in normal conditions?"
  # Allocator (Layer 6) can scale DOWN from here, but this sets the baseline.

# =============================================================================
# ALLOCATOR V1: State-Regime-Risk System (Layer 6 in Canonical Stack)
# =============================================================================
# Production-Ready, December 2024
# Frozen at v1.0 — See docs/ALLOCATOR_V1_FREEZE.md for change policy
allocator_v1:
  enabled: true               # Master switch: true to apply risk scalars, false to compute artifacts only
  mode: "precomputed"         # PRODUCTION DEFAULT: "precomputed" (safe, deterministic, auditable)
  # Modes:
  #   "off":        Compute artifacts only, no weight scaling (baseline generation)
  #   "compute":    On-the-fly computation (research-only, has warmup issues)
  #   "precomputed": Load scalars from validated baseline run (PRODUCTION MODE)
  
  # Profile selection: H (High), M (Medium), L (Low) risk tolerance
  # - H: Rare intervention, tail-only protection, minimal Sharpe drag
  # - M: Balanced approach, active risk management without excessive drag
  # - L: Conservative, institutional-style (default v1 behavior)
  profile: "H"                # RECOMMENDED FOR PRODUCTION: "H" (captures engine alpha)
  
  precomputed_run_id: null    # Run ID to load scalars from (SET THIS for production deployment)
  precomputed_scalar_filename: "allocator_risk_v1_applied.csv"  # Filename to load from baseline
  apply_missing_scalar_as: 1.0  # Default scalar if date not found (no scaling)
  state_version: "v1.0"       # FROZEN
  regime_version: "v1.0"      # FROZEN
  risk_version: "v1.0"        # FROZEN
  
  # Profile-specific overrides (optional, profile defaults are used if not specified)
  # These are automatically set by the profile, but can be overridden here:
  # regime_scalars:
  #   NORMAL: 1.00
  #   ELEVATED: 0.98  # Profile-H default
  #   STRESS: 0.85    # Profile-H default
  #   CRISIS: 0.60    # Profile-H default
  # smoothing_alpha: 0.15  # Profile-H default
  # risk_min: 0.50         # Profile-H default

exec:
  rebalance: "W-FRI"
  slippage_bps: 0.5
  commission_per_contract: 0.0
  position_notional_scale: 1.0

macro_regime:
  enabled: true  # Set to false to disable macro regime overlay
  rebalance: "W-FRI"
  vol_thresholds:
    low: 0.12
    high: 0.22
  k_bounds:
    min: 0.5
    max: 1.0
  smoothing: 0.15
  vol_lookback: 21
  breadth_lookback: 200
  proxy_symbols: ["ES_FRONT_CALENDAR_2D", "NQ_FRONT_CALENDAR_2D"]
  # FRED economic indicators (8-9 indicators as mentioned)
  fred_series: ["VIXCLS", "DGS10", "DGS2", "FEDFUNDS", "UNRATE", "CPIAUCSL", "DTWEXBGS", "TEDRATE"]
  fred_lookback: 252  # 1 year rolling window for normalization
  fred_weight: 0.3    # Weight of FRED signal in scaler calculation

# Strategy sleeves configuration
# IMPORTANT: Weights are RELATIVE IMPORTANCE weights, not absolute risk budgets.
# They are automatically normalized to sum to 1.0 by CombinedStrategy.
# Example: tsmom=0.6, sr3=0.15, rates=0.15, fx_commod=0.10 → normalized to tsmom=0.60, sr3=0.15, rates=0.15, fx_commod=0.10
strategies:
  tsmom:
    enabled: true
    weight: 0.6   # Relative importance weight (will be normalized to sum to 1.0)
    params:
      weights:
        ret_252: 0.5      # Weight for 252-day return momentum
        breakout_252: 0.3  # Weight for 252-day breakout strength
        slope_slow: 0.2    # Weight for slow trend slope
      signal_cap: 3.0     # Signal cap in standard deviations
      rebalance: "W-FRI"   # Rebalance frequency
  
  sr3_carry_curve:
    enabled: true  # Set to true to enable SR3 carry/curve sleeve
    weight: 0.15   # Relative importance weight (will be normalized to sum to 1.0)
    params:
      w_carry: 0.30      # Weight for carry feature
      w_curve: 0.25      # Weight for curve feature
      w_pack_slope: 0.20 # Weight for pack slope feature
      w_front_lvl: 0.10  # Weight for front-pack level feature
      w_curv_belly: 0.15 # Weight for belly curvature feature
      cap: 3.0           # Signal cap in standard deviations
      window: 252        # Rolling window for feature standardization
  
  rates_curve:
    enabled: true  # Set to true to enable rates curve sleeve
    weight: 0.15    # Relative importance weight (will be normalized to sum to 1.0)
    params:
      z_cap: 3.0           # Cap on z-score signals
      w_slope_2s10s: 0.35  # Weight for 2s10s slope feature
      w_slope_5s30s: 0.35  # Weight for 5s30s slope feature
      w_curv_2s5s10s: 0.15 # Weight for 2s-5s-10s curvature feature
      w_curv_5s10s30s: 0.15 # Weight for 5s-10s-30s curvature feature
  
  fx_commod_carry:
    enabled: true  # Set to true to enable FX/Commodity carry sleeve
    weight: 0.10    # Relative importance weight (will be normalized to sum to 1.0)
    params:
      w_ts: 0.6      # Weight for time-series carry feature
      w_xs: 0.25     # Weight for cross-sectional carry feature
      w_mom: 0.15    # Weight for carry momentum feature
      clip: 3.0      # Signal cap in standard deviations
      roots: ["CL", "GC", "6E", "6B", "6J"]  # Roots to trade
      window: 252    # Rolling window for feature standardization
  
  tsmom_med_canonical:
    enabled: false  # Set to true to enable canonical medium-term momentum sleeve
    weight: 0.15    # Relative importance weight (will be normalized to sum to 1.0)
    params:
      signal_cap: 3.0     # Signal cap in standard deviations
      rebalance: "W-FRI"   # Rebalance frequency
  
  tsmom_med:
    enabled: true  # Set to true to enable medium-term momentum sleeve
    weight: 0.15    # Relative importance weight (will be normalized to sum to 1.0)
    params:
      weights:
        ret_84: 0.4      # Weight for 84-day return momentum
        breakout_126: 0.3  # Weight for 126-day breakout strength
        slope_med: 0.2    # Weight for medium trend slope
        persistence: 0.1  # Weight for trend persistence
      signal_cap: 3.0     # Signal cap in standard deviations
      rebalance: "W-FRI"   # Rebalance frequency
  
  tsmom_short:
    enabled: true  # Set to true to enable short-term momentum sleeve
    weight: 0.10    # Relative importance weight (will be normalized to sum to 1.0)
    params:
      weights:
        ret_21: 0.5      # Weight for 21-day return momentum
        breakout_21: 0.3  # Weight for 21-day breakout strength
        slope_fast: 0.2   # Weight for fast trend slope
        reversal_filter: 0.0  # Weight for reversal filter (optional, not used by default)
      signal_cap: 3.0     # Signal cap in standard deviations
      rebalance: "W-FRI"   # Rebalance frequency
  
  tsmom_multihorizon:
    enabled: false  # Set to true to enable multi-horizon TSMOM (v2) sleeve
    weight: 0.6     # Relative importance weight (will be normalized to sum to 1.0)
    params:
      horizon_weights:
        long_252: 0.50   # Weight for long-term horizon (252d)
        med_84: 0.30     # Weight for medium-term horizon (84/126d)
        short_21: 0.20   # Weight for short-term horizon (21d)
        # breakout_mid_50_100: 0.0  # DISABLED by default - enable in experimental profiles only
      feature_weights:
        long:
          ret_252: 0.5       # Weight for 252-day return momentum
          breakout_252: 0.3  # Weight for 252-day breakout strength
          slope_slow: 0.2    # Weight for slow trend slope
        med:
          ret_84: 0.4        # Weight for 84-day return momentum
          breakout_126: 0.3  # Weight for 126-day breakout strength
          slope_med: 0.2     # Weight for medium trend slope
          persistence: 0.1   # Weight for trend persistence
        short:
          ret_21: 0.5        # Weight for 21-day return momentum
          breakout_21: 0.3   # Weight for 21-day breakout strength
          slope_fast: 0.2    # Weight for fast trend slope
          reversal: 0.0      # Weight for reversal filter (not used by default)
        breakout_mid_50_100:
          breakout_50: 0.5   # Weight for 50-day breakout strength
          breakout_100: 0.5  # Weight for 100-day breakout strength
      signal_cap: 3.0     # Signal cap in standard deviations
      rebalance: "W-FRI"   # Rebalance frequency
      vol_normalization:
        enabled: true              # Enable EWMA volatility normalization
        halflife_days: 63          # EWMA half-life in trading days (standard CTA choice)
        sigma_floor_annual: 0.05   # Minimum annualized vol floor (5%)
        risk_scale: 0.2            # Global scale factor for risk-normalized signals
  
  csmom_meta:
    enabled: false  # Set to true to enable Cross-Sectional Momentum Meta-Sleeve
    weight: 0.25     # Relative importance weight (will be normalized to sum to 1.0)
    params:
      lookbacks: [63, 126, 252]  # Multi-horizon lookback periods
      horizon_weights: [0.4, 0.35, 0.25]  # Weights for each horizon (will be normalized)
      vol_lookback: 63  # Lookback for volatility calculation
      rebalance: "D"    # Rebalance frequency ("D" for daily, "W" for weekly)
      neutralize_cross_section: true  # Whether to z-score cross-sectionally
      clip: 3.0  # Z-score clipping threshold

# Strategy Profiles
# These profiles override the default strategies configuration
# Use --strategy_profile <profile_name> in run_strategy.py to select a profile
strategy_profiles:
  momentum_only_v1:
    # Momentum-Only Baseline: Only long-term TSMOM enabled, everything else disabled
    # Use this to test core trend-following performance
    strategies:
      tsmom:
        enabled: true
        weight: 1.0
        params:
          weights:
            ret_252: 0.5
            breakout_252: 0.3
            slope_slow: 0.2
          signal_cap: 3.0
          rebalance: "W-FRI"
      tsmom_med:
        enabled: false
        weight: 0.0
      tsmom_short:
        enabled: false
        weight: 0.0
      sr3_carry_curve:
        enabled: false
        weight: 0.0
      rates_curve:
        enabled: false
        weight: 0.0
      fx_commod_carry:
        enabled: false
        weight: 0.0
    macro_regime:
      enabled: false  # Disable macro overlay for baseline

  momentum_stack_v1:
    # Momentum Stack: Long + Medium + Short term momentum, everything else disabled
    # Tests whether adding medium/short-term momentum improves or degrades performance
    strategies:
      tsmom:
        enabled: true
        weight: 1.0
        params:
          weights:
            ret_252: 0.5
            breakout_252: 0.3
            slope_slow: 0.2
          signal_cap: 3.0
          rebalance: "W-FRI"
      tsmom_med:
        enabled: true
        weight: 0.5
        params:
          weights:
            ret_84: 0.4
            breakout_126: 0.3
            slope_med: 0.2
            persistence: 0.1
          signal_cap: 3.0
          rebalance: "W-FRI"
      tsmom_short:
        enabled: true
        weight: 0.2
        params:
          weights:
            ret_21: 0.5
            breakout_21: 0.3
            slope_fast: 0.2
            reversal_filter: 0.0
          signal_cap: 3.0
          rebalance: "W-FRI"
      sr3_carry_curve:
        enabled: false
        weight: 0.0
      rates_curve:
        enabled: false
        weight: 0.0
      fx_commod_carry:
        enabled: false
        weight: 0.0
    macro_regime:
      enabled: false  # Disable macro overlay for baseline

  momentum_long_fxcarry_v1:
    # Momentum + FX/Commodity Carry: Long-term TSMOM + FX/Commodity carry sleeve
    # Tests whether adding carry signals improves performance
    strategies:
      tsmom:
        enabled: true
        weight: 1.0
        params:
          weights:
            ret_252: 0.5
            breakout_252: 0.3
            slope_slow: 0.2
          signal_cap: 3.0
          rebalance: "W-FRI"
      tsmom_med:
        enabled: false
        weight: 0.0
      tsmom_short:
        enabled: false
        weight: 0.0
      sr3_carry_curve:
        enabled: false
        weight: 0.0
      rates_curve:
        enabled: false
        weight: 0.0
      fx_commod_carry:
        enabled: true
        weight: 1.0
        params:
          w_ts: 0.6
          w_xs: 0.25
          w_mom: 0.15
          clip: 3.0
          roots: ["CL", "GC", "6E", "6B", "6J"]
          window: 252
    macro_regime:
      enabled: false  # Disable macro overlay for baseline

  momentum_long_fxcarry_sr3_v1:
    # Momentum + FX/Commodity Carry + SR3 Carry/Curve: Long-term TSMOM + FX/Commodity carry + SR3 curve
    # Tests whether adding SR3 curve signals improves or degrades performance
    strategies:
      tsmom:
        enabled: true
        weight: 1.0
        params:
          weights:
            ret_252: 0.5
            breakout_252: 0.3
            slope_slow: 0.2
          signal_cap: 3.0
          rebalance: "W-FRI"
      tsmom_med:
        enabled: false
        weight: 0.0
      tsmom_short:
        enabled: false
        weight: 0.0
      sr3_carry_curve:
        enabled: true
        weight: 1.0
        params:
          w_carry: 0.4
          w_curve: 0.3
          w_slope: 0.2
          w_level: 0.1
          clip: 3.0
      rates_curve:
        enabled: false
        weight: 0.0
      fx_commod_carry:
        enabled: true
        weight: 1.0
        params:
          w_ts: 0.6
          w_xs: 0.25
          w_mom: 0.15
          clip: 3.0
          roots: ["CL", "GC", "6E", "6B", "6J"]
          window: 252
    macro_regime:
      enabled: false  # Disable macro overlay for baseline

  core_v2_no_macro:
    # Core v2: Multi-Horizon TSMOM (v2) only, no macro overlay
    # Tests the new unified multi-horizon momentum sleeve
    strategies:
      tsmom_multihorizon:
        enabled: true
        weight: 1.0
        params:
          horizon_weights:
            long_252: 0.50
            med_84: 0.30
            short_21: 0.20
          feature_weights:
            long:
              ret_252: 0.5
              breakout_252: 0.3
              slope_slow: 0.2
            med:
              ret_84: 0.4
              breakout_126: 0.3
              slope_med: 0.2
              persistence: 0.1
            short:
              ret_21: 0.5
              breakout_21: 0.3
              slope_fast: 0.2
              reversal: 0.0
          signal_cap: 3.0
          rebalance: "W-FRI"
          vol_normalization:
            enabled: true
            halflife_days: 63
            sigma_floor_annual: 0.05
            risk_scale: 0.2
      tsmom:
        enabled: false
        weight: 0.0
      tsmom_med:
        enabled: false
        weight: 0.0
      tsmom_short:
        enabled: false
        weight: 0.0
      sr3_carry_curve:
        enabled: false
        weight: 0.0
      rates_curve:
        enabled: false
        weight: 0.0
      fx_commod_carry:
        enabled: false
        weight: 0.0
    macro_regime:
      enabled: false  # Disable macro overlay for baseline

  core_v3_no_macro:
    # Core v3: Multi-Horizon TSMOM (v2) only, no macro overlay
    # Current production baseline - Trend Meta-Sleeve with canonical Long-Term (1/3,1/3,1/3) and canonical Medium-Term (1/3,1/3,1/3)
    # Nov 2025: Promoted canonical Long-Term equal-weight composite (Phase-0/1/2 passed)
    # Nov 2025: Promoted canonical Medium-Term equal-weight composite (Phase-0/1/2 passed)
    # Breakout Mid: Phase-2 approved → Phase-3, 3% horizon weight, 70/30 feature weights
    strategies:
      tsmom_multihorizon:
        enabled: true
        weight: 1.0
        params:
          horizon_weights:
            long_252: 0.485
            med_84: 0.291
            short_21: 0.194
            breakout_mid_50_100: 0.03
          feature_weights:
            long:
              ret_252: 0.333333       # Canonical (1/3) - Promoted Nov 2025
              breakout_252: 0.333333  # Canonical (1/3) - Promoted Nov 2025
              slope_slow: 0.333334    # Canonical (1/3) - Promoted Nov 2025
            med:
              # Canonical medium-term (1/3 each) - Promoted Nov 2025
              # Note: feature_weights are placeholders; actual features come from medium_variant="canonical"
              ret_84: 0.333333        # Canonical (1/3) - Promoted Nov 2025
              breakout_84: 0.333333   # Canonical (1/3) - Promoted Nov 2025
              slope_21_84: 0.333334   # Canonical (1/3) - Promoted Nov 2025
              persistence: 0.0        # Disabled in canonical version
            short:
              ret_21: 0.5
              breakout_21: 0.3
              slope_fast: 0.2
              reversal: 0.0
            breakout_mid_50_100:
              breakout_50: 0.7
              breakout_100: 0.3
          signal_cap: 3.0
          rebalance: "W-FRI"
          vol_normalization:
            enabled: true
            halflife_days: 63
            sigma_floor_annual: 0.05
            risk_scale: 0.2
          # Medium-term variant: canonical (promoted Nov 2025) or legacy
          medium_variant: "canonical"  # Promoted to production Nov 2025
      tsmom:
        enabled: false
        weight: 0.0
      tsmom_med:
        enabled: false
        weight: 0.0
      tsmom_short:
        enabled: false
        weight: 0.0
      sr3_carry_curve:
        enabled: false
        weight: 0.0
      rates_curve:
        enabled: false
        weight: 0.0
      fx_commod_carry:
        enabled: false
        weight: 0.0
      csmom_meta:
        enabled: false
        weight: 0.0
      residual_trend:
        enabled: false
        weight: 0.0
    macro_regime:
      enabled: false  # Disable macro overlay for baseline

  core_v3_no_macro_legacy:
    # Core v3 (LEGACY): Multi-Horizon TSMOM with legacy Long-Term weights (0.5/0.3/0.2) and legacy Medium-Term (0.4/0.3/0.2/0.1)
    # DEPRECATED: For historical comparison only. Use core_v3_no_macro for production.
    # Replaced by canonical Long-Term (1/3,1/3,1/3) in Nov 2025 after Phase-0/1/2 validation
    # Replaced by canonical Medium-Term (1/3,1/3,1/3) in Nov 2025 after Phase-0/1/2 validation
    strategies:
      tsmom_multihorizon:
        enabled: true
        weight: 1.0
        params:
          horizon_weights:
            long_252: 0.485
            med_84: 0.291
            short_21: 0.194
            breakout_mid_50_100: 0.03
          feature_weights:
            long:
              ret_252: 0.5          # Legacy weighting (DEPRECATED)
              breakout_252: 0.3      # Legacy weighting (DEPRECATED)
              slope_slow: 0.2        # Legacy weighting (DEPRECATED)
            med:
              ret_84: 0.4
              breakout_126: 0.3
              slope_med: 0.2
              persistence: 0.1
            short:
              ret_21: 0.5
              breakout_21: 0.3
              slope_fast: 0.2
              reversal: 0.0
            breakout_mid_50_100:
              breakout_50: 0.7
              breakout_100: 0.3
          signal_cap: 3.0
          rebalance: "W-FRI"
          vol_normalization:
            enabled: true
            halflife_days: 63
            sigma_floor_annual: 0.05
            risk_scale: 0.2
      tsmom:
        enabled: false
        weight: 0.0
      tsmom_med:
        enabled: false
        weight: 0.0
      tsmom_short:
        enabled: false
        weight: 0.0
      sr3_carry_curve:
        enabled: false
        weight: 0.0
      rates_curve:
        enabled: false
        weight: 0.0
      fx_commod_carry:
        enabled: false
        weight: 0.0
      csmom_meta:
        enabled: false
        weight: 0.0
      residual_trend:
        enabled: false
        weight: 0.0
    macro_regime:
      enabled: false  # Disable macro overlay for baseline

  core_v3_trend_plus_residual_experiment:
    # Experimental: Trend Meta-Sleeve + Residual Trend atomic sleeve (EXTERNAL BLENDING)
    # Phase-1 integration: Residual Trend added alongside Trend Multi-Horizon as separate sleeve
    # NOTE: This is the old external blending approach. Use core_v3_trend_v2_with_residual for internal integration.
    base_profile: core_v3_no_macro
    strategies:
      tsmom_multihorizon:
        enabled: true
        weight: 0.80  # Trend backbone (reduced from 1.0)
        params:
          horizon_weights:
            long_252: 0.50
            med_84: 0.30
            short_21: 0.20
          feature_weights:
            long:
              ret_252: 0.5
              breakout_252: 0.3
              slope_slow: 0.2
            med:
              ret_84: 0.4
              breakout_126: 0.3
              slope_med: 0.2
              persistence: 0.1
            short:
              ret_21: 0.5
              breakout_21: 0.3
              slope_fast: 0.2
              reversal: 0.0
          signal_cap: 3.0
          rebalance: "W-FRI"
          vol_normalization:
            enabled: true
            halflife_days: 63
            sigma_floor_annual: 0.05
            risk_scale: 0.2
      residual_trend:
        enabled: true
        weight: 0.20  # Residual trend atomic sleeve (external blending)
        params:
          long_lookback: 252
          short_lookback: 21
          signal_cap: 3.0
          rebalance: "W-FRI"
      tsmom:
        enabled: false
        weight: 0.0
      tsmom_med:
        enabled: false
        weight: 0.0
      tsmom_short:
        enabled: false
        weight: 0.0
      sr3_carry_curve:
        enabled: false
        weight: 0.0
      rates_curve:
        enabled: false
        weight: 0.0
      fx_commod_carry:
        enabled: false
        weight: 0.0
      csmom_meta:
        enabled: false
        weight: 0.0
    macro_regime:
      enabled: false  # Disable macro overlay for baseline

  core_v3_trend_plus_persistence_external:
    # Experimental: Trend Meta-Sleeve + Persistence atomic sleeve (EXTERNAL BLENDING)
    # Phase-1 integration: Persistence added alongside Trend Multi-Horizon as separate sleeve
    # NOTE: This is external blending for Phase-1 testing. Internal integration happens in Phase-2.
    strategies:
      tsmom_multihorizon:
        enabled: true
        weight: 0.80  # Trend backbone (reduced from 1.0)
        params:
          horizon_weights:
            long_252: 0.50
            med_84: 0.30
            short_21: 0.20
          feature_weights:
            long:
              ret_252: 0.5
              breakout_252: 0.3
              slope_slow: 0.2
            med:
              ret_84: 0.4
              breakout_126: 0.3
              slope_med: 0.2
              persistence: 0.1
            short:
              ret_21: 0.5
              breakout_21: 0.3
              slope_fast: 0.2
              reversal: 0.0
          signal_cap: 3.0
          rebalance: "W-FRI"
          vol_normalization:
            enabled: true
            halflife_days: 63
            sigma_floor_annual: 0.05
            risk_scale: 0.2
      persistence:
        enabled: true
        weight: 0.20  # Persistence atomic sleeve (external blending)
        params:
          weights:
            slope_accel: 0.80
            breakout_accel: 0.10
            return_accel: 0.10
          signal_cap: 3.0
          rebalance: "W-FRI"
      tsmom:
        enabled: false
        weight: 0.0
      tsmom_med:
        enabled: false
        weight: 0.0
      tsmom_short:
        enabled: false
        weight: 0.0
      sr3_carry_curve:
        enabled: false
        weight: 0.0
      rates_curve:
        enabled: false
        weight: 0.0
      fx_commod_carry:
        enabled: false
        weight: 0.0
      csmom_meta:
        enabled: false
        weight: 0.0
      residual_trend:
        enabled: false
        weight: 0.0
    macro_regime:
      enabled: false  # Disable macro overlay for baseline

  persistence_phase1:
    # Phase-1: Standalone Persistence atomic sleeve for diagnostics
    # This profile runs ONLY persistence to validate the atomic sleeve independently
    strategies:
      persistence:
        enabled: true
        weight: 1.0  # 100% persistence
        params:
          weights:
            slope_accel: 0.80
            breakout_accel: 0.10
            return_accel: 0.10
          signal_cap: 3.0
          rebalance: "W-FRI"
      tsmom_multihorizon:
        enabled: false
        weight: 0.0
      tsmom:
        enabled: false
        weight: 0.0
      tsmom_med:
        enabled: false
        weight: 0.0
      tsmom_short:
        enabled: false
        weight: 0.0
      sr3_carry_curve:
        enabled: false
        weight: 0.0
      rates_curve:
        enabled: false
        weight: 0.0
      fx_commod_carry:
        enabled: false
        weight: 0.0
      csmom_meta:
        enabled: false
        weight: 0.0
      residual_trend:
        enabled: false
        weight: 0.0
    macro_regime:
      enabled: false  # Disable macro overlay for baseline

  core_v3_trend_v2_with_residual:
    # Experimental: Trend Meta-Sleeve v2 with Residual Trend as 4th atomic sleeve (INTERNAL BLENDING)
    # Residual Trend is now integrated inside TSMOMMultiHorizon as an internal atomic sleeve
    # This is the clean architecture: all trend atomic ideas inside Trend Meta-Sleeve
    strategies:
      tsmom_multihorizon:
        enabled: true
        weight: 1.0  # Full weight on Trend Meta-Sleeve (residual included internally)
        params:
          horizon_weights:
            long_252: 0.45      # Reduced from 0.50 to make room for residual
            med_84: 0.28         # Reduced from 0.30
            short_21: 0.20       # Unchanged
            residual_252_21: 0.15  # NEW: Residual trend as 4th atomic sleeve
          feature_weights:
            long:
              ret_252: 0.5
              breakout_252: 0.3
              slope_slow: 0.2
            med:
              ret_84: 0.4
              breakout_126: 0.3
              slope_med: 0.2
              persistence: 0.1
            short:
              ret_21: 0.5
              breakout_21: 0.3
              slope_fast: 0.2
              reversal: 0.0
          signal_cap: 3.0
          rebalance: "W-FRI"
          vol_normalization:
            enabled: true
            halflife_days: 63
            sigma_floor_annual: 0.05
            risk_scale: 0.2
      tsmom:
        enabled: false
        weight: 0.0
      tsmom_med:
        enabled: false
        weight: 0.0
      tsmom_short:
        enabled: false
        weight: 0.0
      sr3_carry_curve:
        enabled: false
        weight: 0.0
      rates_curve:
        enabled: false
        weight: 0.0
      fx_commod_carry:
        enabled: false
        weight: 0.0
      csmom_meta:
        enabled: false
        weight: 0.0
      residual_trend:
        enabled: false
        weight: 0.0  # Disabled - now part of tsmom_multihorizon internally
      persistence:
        enabled: false
        weight: 0.0  # Phase-1 experimental, not integrated internally yet
    macro_regime:
      enabled: false  # Disable macro overlay for baseline

  core_v4_trend_csmom_no_macro:
    # Core v4: Trend Meta-Sleeve + CSMOM Meta-Sleeve, no macro overlay
    # Phase-2 integration: CSMOM added alongside Trend
    # STATUS: Superseded by core_v5_trend_csmom_vrp_core_no_macro (Dec 2025)
    # Kept for historical comparison; replaced after VRP-Core Phase-2 promotion
    name: core_v4_trend_csmom_no_macro
    description: "Trend + CSMOM baseline WITHOUT VRP (superseded by core_v5)."
    is_baseline: false
    status: "superseded"
    notes: "Kept for historical comparison; replaced by core_v5_trend_csmom_vrp_core_no_macro after VRP-Core Phase-2 promotion."
    strategies:
      tsmom_multihorizon:
        enabled: true
        weight: 0.75  # Trend backbone
        params:
          horizon_weights:
            long_252: 0.50
            med_84: 0.30
            short_21: 0.20
          feature_weights:
            long:
              ret_252: 0.5
              breakout_252: 0.3
              slope_slow: 0.2
            med:
              ret_84: 0.4
              breakout_126: 0.3
              slope_med: 0.2
              persistence: 0.1
            short:
              ret_21: 0.5
              breakout_21: 0.3
              slope_fast: 0.2
              reversal: 0.0
          signal_cap: 3.0
          rebalance: "W-FRI"
          vol_normalization:
            enabled: true
            halflife_days: 63
            sigma_floor_annual: 0.05
            risk_scale: 0.2
      csmom_meta:
        enabled: true
        weight: 0.25  # CSMOM spice
        params:
          lookbacks: [63, 126, 252]
          horizon_weights: [0.4, 0.35, 0.25]
          vol_lookback: 63
          rebalance: "D"
          neutralize_cross_section: true
          clip: 3.0
      tsmom:
        enabled: false
        weight: 0.0
      tsmom_med:
        enabled: false
        weight: 0.0
      tsmom_short:
        enabled: false
        weight: 0.0
      sr3_carry_curve:
        enabled: false
        weight: 0.0
      rates_curve:
        enabled: false
        weight: 0.0
      fx_commod_carry:
        enabled: false
        weight: 0.0
    macro_regime:
      enabled: false  # Disable macro overlay for baseline

  core_v5_trend_csmom_vrp_core_no_macro:
    # Core v5: Trend Meta-Sleeve + CSMOM Meta-Sleeve + VRP-Core Meta-Sleeve, no macro overlay
    # Phase-2 integration: VRP-Core added alongside Trend + CSMOM
    # STATUS: Historical reference baseline (superseded by Core v6, Dec 2025)
    name: core_v5_trend_csmom_vrp_core_no_macro
    display_name: "Core v5"
    description: "Trend + CSMOM + VRP-Core; no macro overlays"
    is_baseline: false
    status: "historical_reference"
    components:
      trend_meta: true
      csmom_meta: true
      vrp_core: true
      vrp_convergence: false
    overlays:
      macro: false
    notes: "Promoted to baseline on Phase-2 pass: Sharpe +0.0074, small CAGR +0.11%, MaxDD slightly improved vs core_v4."
    strategies:
      tsmom_multihorizon:
        enabled: true
        weight: 0.65  # Trend backbone (reduced from 0.75 to make room for VRP)
        params:
          horizon_weights:
            long_252: 0.50
            med_84: 0.30
            short_21: 0.20
          feature_weights:
            long:
              ret_252: 0.5
              breakout_252: 0.3
              slope_slow: 0.2
            med:
              ret_84: 0.4
              breakout_126: 0.3
              slope_med: 0.2
              persistence: 0.1
            short:
              ret_21: 0.5
              breakout_21: 0.3
              slope_fast: 0.2
              reversal: 0.0
          signal_cap: 3.0
          rebalance: "W-FRI"
          vol_normalization:
            enabled: true
            halflife_days: 63
            sigma_floor_annual: 0.05
            risk_scale: 0.2
      csmom_meta:
        enabled: true
        weight: 0.25  # CSMOM spice (unchanged)
        params:
          lookbacks: [63, 126, 252]
          horizon_weights: [0.4, 0.35, 0.25]
          vol_lookback: 63
          rebalance: "D"
          neutralize_cross_section: true
          clip: 3.0
      vrp_core_meta:
        enabled: true
        weight: 0.10  # VRP-Core modest allocation (10% of sleeve-level risk)
        params:
          rv_lookback: 21
          zscore_window: 252
          clip: 3.0
          signal_mode: "zscore"
      tsmom:
        enabled: false
        weight: 0.0
      tsmom_med:
        enabled: false
        weight: 0.0
      tsmom_short:
        enabled: false
        weight: 0.0
      sr3_carry_curve:
        enabled: false
        weight: 0.0
      rates_curve:
        enabled: false
        weight: 0.0
      fx_commod_carry:
        enabled: false
        weight: 0.0
    macro_regime:
      enabled: false  # Disable macro overlay for baseline
  
  core_v6_trend_csmom_vrp_core_convergence_no_macro:
    # Core v6: Trend Meta-Sleeve + CSMOM Meta-Sleeve + VRP-Core Meta-Sleeve + VRP-Convergence Meta-Sleeve, no macro overlay
    # Phase-2 integration: VRP-Convergence added alongside existing sleeves
    # STATUS: Current canonical baseline (promoted Dec 2025)
    name: core_v6_trend_csmom_vrp_core_convergence_no_macro
    display_name: "Core v6"
    description: "Trend + CSMOM + VRP-Core + VRP-Convergence; no macro overlays"
    is_baseline: true
    status: "baseline"
    components:
      trend_meta: true
      csmom_meta: true
      vrp_core: true
      vrp_convergence: true
    overlays:
      macro: false
    notes: "Phase-2 test: Adding VRP-Convergence (5%) to core_v5 baseline. VRP-Core reduced to 7.5% to make room."
    strategies:
      tsmom_multihorizon:
        enabled: true
        weight: 0.625  # Trend backbone (reduced from 0.65 to make room for VRP-Convergence)
        params:
          horizon_weights:
            long_252: 0.50
            med_84: 0.30
            short_21: 0.20
          feature_weights:
            long:
              ret_252: 0.5
              breakout_252: 0.3
              slope_slow: 0.2
            med:
              ret_84: 0.4
              breakout_126: 0.3
              slope_med: 0.2
              persistence: 0.1
            short:
              ret_21: 0.5
              breakout_21: 0.3
              slope_fast: 0.2
              reversal: 0.0
          signal_cap: 3.0
          rebalance: "W-FRI"
          vol_normalization:
            enabled: true
            halflife_days: 63
            sigma_floor_annual: 0.05
            risk_scale: 0.2
      csmom_meta:
        enabled: true
        weight: 0.25  # CSMOM spice (unchanged)
        params:
          lookbacks: [63, 126, 252]
          horizon_weights: [0.4, 0.35, 0.25]
          vol_lookback: 63
          rebalance: "D"
          neutralize_cross_section: true
          clip: 3.0
      vrp_core_meta:
        enabled: true
        weight: 0.075  # VRP-Core reduced from 0.10 to make room for VRP-Convergence
        params:
          rv_lookback: 21
          zscore_window: 252
          clip: 3.0
          signal_mode: "zscore"
      vrp_convergence_meta:
        enabled: true
        weight: 0.05  # VRP-Convergence modest allocation (5% of sleeve-level risk)
        params:
          zscore_window: 252
          clip: 3.0
          signal_mode: "zscore"
          target_vol: 0.10
          vol_lookback: 63
          vol_floor: 0.05
      tsmom:
        enabled: false
        weight: 0.0
      tsmom_med:
        enabled: false
        weight: 0.0
      tsmom_short:
        enabled: false
        weight: 0.0
      sr3_carry_curve:
        enabled: false
        weight: 0.0
      rates_curve:
        enabled: false
        weight: 0.0
      fx_commod_carry:
        enabled: false
        weight: 0.0
    macro_regime:
      enabled: false  # Disable macro overlay for baseline

  core_v6_trend_csmom_vrp_core_convergence_vrp_alt_no_macro:
    # Core v6 + VRP-Alt: Trend Meta-Sleeve + CSMOM Meta-Sleeve + VRP-Core Meta-Sleeve + VRP-Convergence Meta-Sleeve + VRP-Alt Meta-Sleeve, no macro overlay
    # Phase-2 integration: VRP-Alt added alongside existing sleeves
    # STATUS: Phase-2 experimental variant
    name: core_v6_trend_csmom_vrp_core_convergence_vrp_alt_no_macro
    display_name: "Core v6 + VRP-Alt"
    description: "Trend + CSMOM + VRP-Core + VRP-Convergence + VRP-Alt; no macro overlays"
    is_baseline: false
    status: "phase2_experimental"
    components:
      trend_meta: true
      csmom_meta: true
      vrp_core: true
      vrp_convergence: true
      vrp_alt: true
    overlays:
      macro: false
    notes: "Phase-2 test: Adding VRP-Alt (5%) to core_v6 baseline. Trend reduced by 2.5%, VRP-Convergence reduced from 5% to 2.5% to make room."
    strategies:
      tsmom_multihorizon:
        enabled: true
        weight: 0.60  # Trend backbone (reduced by 2.5% to help fund VRP-Alt)
        params:
          horizon_weights:
            long_252: 0.50
            med_84: 0.30
            short_21: 0.20
          feature_weights:
            long:
              ret_252: 0.5
              breakout_252: 0.3
              slope_slow: 0.2
            med:
              ret_84: 0.4
              breakout_126: 0.3
              slope_med: 0.2
              persistence: 0.1
            short:
              ret_21: 0.5
              breakout_21: 0.3
              slope_fast: 0.2
              reversal: 0.0
          signal_cap: 3.0
          rebalance: "W-FRI"
          vol_normalization:
            enabled: true
            halflife_days: 63
            sigma_floor_annual: 0.05
            risk_scale: 0.2
      csmom_meta:
        enabled: true
        weight: 0.25  # CSMOM spice (unchanged)
        params:
          lookbacks: [63, 126, 252]
          horizon_weights: [0.4, 0.35, 0.25]
          vol_lookback: 63
          rebalance: "D"
          neutralize_cross_section: true
          clip: 3.0
      vrp_core_meta:
        enabled: true
        weight: 0.075  # VRP-Core unchanged (keeps VRP-Core at prior allocation)
        params:
          rv_lookback: 21
          zscore_window: 252
          clip: 3.0
          signal_mode: "zscore"
      vrp_convergence_meta:
        enabled: true
        weight: 0.025  # VRP-Convergence reduced from 5% to 2.5%
        params:
          zscore_window: 252
          clip: 3.0
          signal_mode: "zscore"
          target_vol: 0.10
          vol_lookback: 63
          vol_floor: 0.05
      vrp_alt_meta:
        enabled: true
        weight: 0.05  # NEW: VRP-Alt receives 5% risk budget
        params:
          zscore_window: 252
          clip: 3.0
          signal_mode: "zscore"
          target_vol: 0.10
          vol_lookback: 63
          vol_floor: 0.05
      tsmom:
        enabled: false
        weight: 0.0
      tsmom_med:
        enabled: false
        weight: 0.0
      tsmom_short:
        enabled: false
        weight: 0.0
      sr3_carry_curve:
        enabled: false
        weight: 0.0
      rates_curve:
        enabled: false
        weight: 0.0
      fx_commod_carry:
        enabled: false
        weight: 0.0
    macro_regime:
      enabled: false  # Disable macro overlay for baseline

  core_v8_trend_csmom_vrp_core_convergence_vrp_alt_vx_carry_no_macro:
    # Core v8: Core v7 + VX Calendar Carry (5%)
    # STATUS: ✅ PRODUCTION BASELINE (Dec 2025)
    # VX Carry promoted at 5% weight after Phase-2 validation
    # All Core v7 sleeve weights scaled by 0.95 to accommodate VX Carry
    name: core_v8_trend_csmom_vrp_core_convergence_vrp_alt_vx_carry_no_macro
    display_name: "Core v8"
    description: "Core v7 + VX Calendar Carry (5%); no macro overlays"
    is_baseline: true
    status: "production_baseline"
    components:
      trend_meta: true
      csmom_meta: true
      vrp_core: true
      vrp_convergence: true
      vrp_alt: true
      vx_carry: true
    overlays:
      macro: false
    notes: "Core v8: VX Calendar Carry promoted at 5% weight. Canonical atomic: vx2_vx1_short. Final composition: Trend 57%, CSMOM 23.75%, VRP-Core 7.125%, VRP-Convergence 2.375%, VRP-Alt 14.25%, VX Carry 5%."
    strategies:
      tsmom_multihorizon:
        enabled: true
        weight: 0.57  # Trend backbone (scaled from 0.60 by 0.95)
        params:
          horizon_weights:
            long_252: 0.50
            med_84: 0.30
            short_21: 0.20
          feature_weights:
            long:
              ret_252: 0.5
              breakout_252: 0.3
              slope_slow: 0.2
            med:
              ret_84: 0.4
              breakout_126: 0.3
              slope_med: 0.2
              persistence: 0.1
            short:
              ret_21: 0.5
              breakout_21: 0.3
              slope_fast: 0.2
              reversal: 0.0
          signal_cap: 3.0
          rebalance: "W-FRI"
          vol_normalization:
            enabled: true
            halflife_days: 63
            sigma_floor_annual: 0.05
            risk_scale: 0.2
      csmom_meta:
        enabled: true
        weight: 0.2375  # CSMOM spice (scaled from 0.25 by 0.95)
        params:
          lookbacks: [63, 126, 252]
          horizon_weights: [0.4, 0.35, 0.25]
          vol_lookback: 63
          rebalance: "D"
          neutralize_cross_section: true
          clip: 3.0
      vrp_core_meta:
        enabled: true
        weight: 0.07125  # VRP-Core (scaled from 0.075 by 0.95)
        params:
          rv_lookback: 21
          zscore_window: 252
          clip: 3.0
          signal_mode: "zscore"
      vrp_convergence_meta:
        enabled: true
        weight: 0.02375  # VRP-Convergence (scaled from 0.025 by 0.95)
        params:
          zscore_window: 252
          clip: 3.0
          signal_mode: "zscore"
          target_vol: 0.10
          vol_lookback: 63
          vol_floor: 0.05
      vrp_alt_meta:
        enabled: true
        weight: 0.1425  # VRP-Alt (scaled from 0.15 by 0.95)
        params:
          zscore_window: 252
          clip: 3.0
          signal_mode: "zscore"
          target_vol: 0.10
          vol_lookback: 63
          vol_floor: 0.05
      vx_calendar_carry:
        enabled: true
        weight: 0.05  # VX Calendar Carry (canonical: vx2_vx1_short)
        params:
          variant: "vx2_vx1_short"  # Canonical atomic sleeve
          zscore_window: 90
          clip: 2.0
          target_vol: 0.10
          vol_lookback: 60
          min_vol_floor: 0.01
          max_leverage: 10.0
          lag: 1
      tsmom:
        enabled: false
        weight: 0.0
      tsmom_med:
        enabled: false
        weight: 0.0
      tsmom_short:
        enabled: false
        weight: 0.0
      sr3_carry_curve:
        enabled: false
        weight: 0.0
      rates_curve:
        enabled: false
        weight: 0.0
      fx_commod_carry:
        enabled: false
        weight: 0.0
    macro_regime:
      enabled: false  # Disable macro overlay for baseline

  core_v9_trend_csmom_vrp_core_convergence_vrp_alt_vx_carry_sr3_curverv_no_macro:
    # Core v9: Core v8 + Curve RV Meta-Sleeve (8% total)
    # STATUS: ✅ PRODUCTION BASELINE (Dec 2025)
    # Curve RV: Rank Fly Momentum (5%) + Pack Slope Momentum (3%)
    # All Core v8 sleeve weights scaled by 0.92 to accommodate Curve RV 8%
    name: core_v9_trend_csmom_vrp_core_convergence_vrp_alt_vx_carry_sr3_curverv_no_macro
    display_name: "Core v9"
    description: "Core v8 + SR3 Curve RV Meta-Sleeve (Rank Fly 5% + Pack Slope 3%); no macro overlays"
    is_baseline: true
    status: "production_baseline"
    components:
      trend_meta: true
      csmom_meta: true
      vrp_core: true
      vrp_convergence: true
      vrp_alt: true
      vx_carry: true
      curve_rv: true
    overlays:
      macro: false
    notes: "Core v9: Curve RV Meta-Sleeve promoted at 8% total (Rank Fly 5% + Pack Slope 3%). All Core v8 sleeves scaled by 0.92. Final composition: Trend 52.4%, CSMOM 21.85%, VRP-Core 6.555%, VRP-Convergence 2.185%, VRP-Alt 13.11%, VX Carry 4.6%, Curve RV 8%."
    strategies:
      tsmom_multihorizon:
        enabled: true
        weight: 0.5244  # Trend backbone (scaled from 0.57 by 0.92)
        params:
          horizon_weights:
            long_252: 0.50
            med_84: 0.30
            short_21: 0.20
          feature_weights:
            long:
              ret_252: 0.5
              breakout_252: 0.3
              slope_slow: 0.2
            med:
              ret_84: 0.4
              breakout_126: 0.3
              slope_med: 0.2
              persistence: 0.1
            short:
              ret_21: 0.5
              breakout_21: 0.3
              slope_fast: 0.2
              reversal: 0.0
          signal_cap: 3.0
          rebalance: "W-FRI"
          vol_normalization:
            enabled: true
            halflife_days: 63
            sigma_floor_annual: 0.05
            risk_scale: 0.2
      csmom_meta:
        enabled: true
        weight: 0.2185  # CSMOM spice (scaled from 0.2375 by 0.92)
        params:
          lookbacks: [63, 126, 252]
          horizon_weights: [0.4, 0.35, 0.25]
          vol_lookback: 63
          rebalance: "D"
          neutralize_cross_section: true
          clip: 3.0
      vrp_core_meta:
        enabled: true
        weight: 0.06555  # VRP-Core (scaled from 0.07125 by 0.92)
        params:
          rv_lookback: 21
          zscore_window: 252
          clip: 3.0
          signal_mode: "zscore"
      vrp_convergence_meta:
        enabled: true
        weight: 0.02185  # VRP-Convergence (scaled from 0.02375 by 0.92)
        params:
          zscore_window: 252
          clip: 3.0
          signal_mode: "zscore"
          target_vol: 0.10
          vol_lookback: 63
          vol_floor: 0.05
      vrp_alt_meta:
        enabled: true
        weight: 0.1311  # VRP-Alt (scaled from 0.1425 by 0.92)
        params:
          zscore_window: 252
          clip: 3.0
          signal_mode: "zscore"
          target_vol: 0.10
          vol_lookback: 63
          vol_floor: 0.05
      vx_calendar_carry:
        enabled: true
        weight: 0.046  # VX Calendar Carry (scaled from 0.05 by 0.92)
        params:
          variant: "vx2_vx1_short"
          zscore_window: 90
          clip: 2.0
          target_vol: 0.10
          vol_lookback: 60
          min_vol_floor: 0.01
          max_leverage: 10.0
          lag: 1
      sr3_curve_rv_meta:
        enabled: true
        weight: 0.08  # Curve RV Meta-Sleeve (8% total: Rank Fly 5% + Pack Slope 3%)
        params:
          enabled_atomics: ["rank_fly", "pack_slope"]
          atomic_weights:
            rank_fly: 0.625
            pack_slope: 0.375
          zscore_window: 252
          clip: 3.0
          target_vol: 0.10
          vol_lookback: 63
          min_vol_floor: 0.01
          max_leverage: 10.0
          lag: 1
      tsmom:
        enabled: false
        weight: 0.0
      tsmom_med:
        enabled: false
        weight: 0.0
      tsmom_short:
        enabled: false
        weight: 0.0
      sr3_carry_curve:
        enabled: false
        weight: 0.0
      rates_curve:
        enabled: false
        weight: 0.0
      fx_commod_carry:
        enabled: false
        weight: 0.0
    macro_regime:
      enabled: false  # Disable macro overlay for baseline

  core_v9_trend_csmom_vrp_core_convergence_vrp_alt_vx_carry_sr3_curverv_rankfly_no_macro:
    # Core v9: Core v8 + Curve RV Rank Fly (5%)
    # STATUS: Phase-2 test variant
    # All Core v8 sleeve weights scaled by 0.95 to accommodate Curve RV Rank Fly (5%)
    name: core_v9_trend_csmom_vrp_core_convergence_vrp_alt_vx_carry_sr3_curverv_rankfly_no_macro
    display_name: "Core v9 + Rank Fly (5%)"
    description: "Core v8 + SR3 Curve RV Rank Fly Momentum (5%); no macro overlays"
    is_baseline: false
    status: "phase2_test"
    components:
      trend_meta: true
      csmom_meta: true
      vrp_core: true
      vrp_convergence: true
      vrp_alt: true
      vx_carry: true
      curve_rv: true
    overlays:
      macro: false
    notes: "Core v9 Phase-2: Rank Fly Momentum at 5% weight. All Core v8 sleeves scaled by 0.95."
    strategies:
      tsmom_multihorizon:
        enabled: true
        weight: 0.5415  # Trend backbone (scaled from 0.57 by 0.95)
        params:
          horizon_weights:
            long_252: 0.50
            med_84: 0.30
            short_21: 0.20
          feature_weights:
            long:
              ret_252: 0.5
              breakout_252: 0.3
              slope_slow: 0.2
            med:
              ret_84: 0.4
              breakout_126: 0.3
              slope_med: 0.2
              persistence: 0.1
            short:
              ret_21: 0.5
              breakout_21: 0.3
              slope_fast: 0.2
              reversal: 0.0
          signal_cap: 3.0
          rebalance: "W-FRI"
          vol_normalization:
            enabled: true
            halflife_days: 63
            sigma_floor_annual: 0.05
            risk_scale: 0.2
      csmom_meta:
        enabled: true
        weight: 0.225625  # CSMOM spice (scaled from 0.2375 by 0.95)
        params:
          lookbacks: [63, 126, 252]
          horizon_weights: [0.4, 0.35, 0.25]
          vol_lookback: 63
          rebalance: "D"
          neutralize_cross_section: true
          clip: 3.0
      vrp_core_meta:
        enabled: true
        weight: 0.0676875  # VRP-Core (scaled from 0.07125 by 0.95)
        params:
          rv_lookback: 21
          zscore_window: 252
          clip: 3.0
          signal_mode: "zscore"
      vrp_convergence_meta:
        enabled: true
        weight: 0.0225625  # VRP-Convergence (scaled from 0.02375 by 0.95)
        params:
          zscore_window: 252
          clip: 3.0
          signal_mode: "zscore"
          target_vol: 0.10
          vol_lookback: 63
          vol_floor: 0.05
      vrp_alt_meta:
        enabled: true
        weight: 0.135375  # VRP-Alt (scaled from 0.1425 by 0.95)
        params:
          zscore_window: 252
          clip: 3.0
          signal_mode: "zscore"
          target_vol: 0.10
          vol_lookback: 63
          vol_floor: 0.05
      vx_calendar_carry:
        enabled: true
        weight: 0.0475  # VX Calendar Carry (scaled from 0.05 by 0.95)
        params:
          variant: "vx2_vx1_short"
          zscore_window: 90
          clip: 2.0
          target_vol: 0.10
          vol_lookback: 60
          min_vol_floor: 0.01
          max_leverage: 10.0
          lag: 1
      sr3_curve_rv_meta:
        enabled: true
        weight: 0.05  # Curve RV Rank Fly (5%)
        params:
          enabled_atomics: ["rank_fly"]
          atomic_weights:
            rank_fly: 1.0
          zscore_window: 252
          clip: 3.0
          target_vol: 0.10
          vol_lookback: 63
          min_vol_floor: 0.01
          max_leverage: 10.0
          lag: 1
      tsmom:
        enabled: false
        weight: 0.0
      tsmom_med:
        enabled: false
        weight: 0.0
      tsmom_short:
        enabled: false
        weight: 0.0
      sr3_carry_curve:
        enabled: false
        weight: 0.0
      rates_curve:
        enabled: false
        weight: 0.0
      fx_commod_carry:
        enabled: false
        weight: 0.0
    macro_regime:
      enabled: false

  core_v9_trend_csmom_vrp_core_convergence_vrp_alt_vx_carry_sr3_curverv_packslope_no_macro:
    # Core v9: Core v8 + Curve RV Pack Slope (3%)
    # STATUS: Phase-2 test variant
    # All Core v8 sleeve weights scaled by 0.97 to accommodate Curve RV Pack Slope (3%)
    name: core_v9_trend_csmom_vrp_core_convergence_vrp_alt_vx_carry_sr3_curverv_packslope_no_macro
    display_name: "Core v9 + Pack Slope (3%)"
    description: "Core v8 + SR3 Curve RV Pack Slope Momentum (3%); no macro overlays"
    is_baseline: false
    status: "phase2_test"
    components:
      trend_meta: true
      csmom_meta: true
      vrp_core: true
      vrp_convergence: true
      vrp_alt: true
      vx_carry: true
      curve_rv: true
    overlays:
      macro: false
    notes: "Core v9 Phase-2: Pack Slope Momentum at 3% weight. All Core v8 sleeves scaled by 0.97."
    strategies:
      tsmom_multihorizon:
        enabled: true
        weight: 0.5529  # Trend backbone (scaled from 0.57 by 0.97)
        params:
          horizon_weights:
            long_252: 0.50
            med_84: 0.30
            short_21: 0.20
          feature_weights:
            long:
              ret_252: 0.5
              breakout_252: 0.3
              slope_slow: 0.2
            med:
              ret_84: 0.4
              breakout_126: 0.3
              slope_med: 0.2
              persistence: 0.1
            short:
              ret_21: 0.5
              breakout_21: 0.3
              slope_fast: 0.2
              reversal: 0.0
          signal_cap: 3.0
          rebalance: "W-FRI"
          vol_normalization:
            enabled: true
            halflife_days: 63
            sigma_floor_annual: 0.05
            risk_scale: 0.2
      csmom_meta:
        enabled: true
        weight: 0.230375  # CSMOM spice (scaled from 0.2375 by 0.97)
        params:
          lookbacks: [63, 126, 252]
          horizon_weights: [0.4, 0.35, 0.25]
          vol_lookback: 63
          rebalance: "D"
          neutralize_cross_section: true
          clip: 3.0
      vrp_core_meta:
        enabled: true
        weight: 0.0691125  # VRP-Core (scaled from 0.07125 by 0.97)
        params:
          rv_lookback: 21
          zscore_window: 252
          clip: 3.0
          signal_mode: "zscore"
      vrp_convergence_meta:
        enabled: true
        weight: 0.0230375  # VRP-Convergence (scaled from 0.02375 by 0.97)
        params:
          zscore_window: 252
          clip: 3.0
          signal_mode: "zscore"
          target_vol: 0.10
          vol_lookback: 63
          vol_floor: 0.05
      vrp_alt_meta:
        enabled: true
        weight: 0.138225  # VRP-Alt (scaled from 0.1425 by 0.97)
        params:
          zscore_window: 252
          clip: 3.0
          signal_mode: "zscore"
          target_vol: 0.10
          vol_lookback: 63
          vol_floor: 0.05
      vx_calendar_carry:
        enabled: true
        weight: 0.0485  # VX Calendar Carry (scaled from 0.05 by 0.97)
        params:
          variant: "vx2_vx1_short"
          zscore_window: 90
          clip: 2.0
          target_vol: 0.10
          vol_lookback: 60
          min_vol_floor: 0.01
          max_leverage: 10.0
          lag: 1
      sr3_curve_rv_meta:
        enabled: true
        weight: 0.03  # Curve RV Pack Slope (3%)
        params:
          enabled_atomics: ["pack_slope"]
          atomic_weights:
            pack_slope: 1.0
          zscore_window: 252
          clip: 3.0
          target_vol: 0.10
          vol_lookback: 63
          min_vol_floor: 0.01
          max_leverage: 10.0
          lag: 1
      tsmom:
        enabled: false
        weight: 0.0
      tsmom_med:
        enabled: false
        weight: 0.0
      tsmom_short:
        enabled: false
        weight: 0.0
      sr3_carry_curve:
        enabled: false
        weight: 0.0
      rates_curve:
        enabled: false
        weight: 0.0
      fx_commod_carry:
        enabled: false
        weight: 0.0
    macro_regime:
      enabled: false

  core_v7_trend_csmom_vrp_core_convergence_vrp_alt_no_macro:
    # Core v7: Trend Meta-Sleeve + CSMOM Meta-Sleeve + VRP-Core Meta-Sleeve + VRP-Convergence Meta-Sleeve + VRP-Alt Meta-Sleeve, no macro overlay
    # STATUS: ⚠️ SUPERSEDED by Core v8 (Dec 2025)
    # VRP-Alt promoted at 15% weight after scaling analysis
    name: core_v7_trend_csmom_vrp_core_convergence_vrp_alt_no_macro
    display_name: "Core v7"
    description: "Trend + CSMOM + VRP-Core + VRP-Convergence + VRP-Alt; no macro overlays (Superseded by Core v8)"
    is_baseline: false
    status: "superseded"
    components:
      trend_meta: true
      csmom_meta: true
      vrp_core: true
      vrp_convergence: true
      vrp_alt: true
    overlays:
      macro: false
    notes: "Core v7: VRP-Alt promoted at 15% weight. Final composition: Trend 60%, CSMOM 25%, VRP-Core 7.5%, VRP-Convergence 2.5%, VRP-Alt 15%."
    strategies:
      tsmom_multihorizon:
        enabled: true
        weight: 0.60  # Trend backbone (unchanged from Core v6)
        params:
          horizon_weights:
            long_252: 0.50
            med_84: 0.30
            short_21: 0.20
          feature_weights:
            long:
              ret_252: 0.5
              breakout_252: 0.3
              slope_slow: 0.2
            med:
              ret_84: 0.4
              breakout_126: 0.3
              slope_med: 0.2
              persistence: 0.1
            short:
              ret_21: 0.5
              breakout_21: 0.3
              slope_fast: 0.2
              reversal: 0.0
          signal_cap: 3.0
          rebalance: "W-FRI"
          vol_normalization:
            enabled: true
            halflife_days: 63
            sigma_floor_annual: 0.05
            risk_scale: 0.2
      csmom_meta:
        enabled: true
        weight: 0.25  # CSMOM spice (unchanged)
        params:
          lookbacks: [63, 126, 252]
          horizon_weights: [0.4, 0.35, 0.25]
          vol_lookback: 63
          rebalance: "D"
          neutralize_cross_section: true
          clip: 3.0
      vrp_core_meta:
        enabled: true
        weight: 0.075  # VRP-Core (unchanged from Core v6)
        params:
          rv_lookback: 21
          zscore_window: 252
          clip: 3.0
          signal_mode: "zscore"
      vrp_convergence_meta:
        enabled: true
        weight: 0.025  # VRP-Convergence (kept but de-emphasized)
        params:
          zscore_window: 252
          clip: 3.0
          signal_mode: "zscore"
          target_vol: 0.10
          vol_lookback: 63
          vol_floor: 0.05
      vrp_alt_meta:
        enabled: true
        weight: 0.15  # VRP-Alt promoted at 15% weight (optimal from scaling analysis)
        params:
          zscore_window: 252
          clip: 3.0
          signal_mode: "zscore"
          target_vol: 0.10
          vol_lookback: 63
          vol_floor: 0.05
      tsmom:
        enabled: false
        weight: 0.0
      tsmom_med:
        enabled: false
        weight: 0.0
      tsmom_short:
        enabled: false
        weight: 0.0
      sr3_carry_curve:
        enabled: false
        weight: 0.0
      rates_curve:
        enabled: false
        weight: 0.0
      fx_commod_carry:
        enabled: false
        weight: 0.0
    macro_regime:
      enabled: false  # Disable macro overlay for baseline

  core_v6_trend_csmom_vrp_core_convergence_vrp_alt_7p5_no_macro:
    # Core v6 + VRP-Alt (7.5%): Phase-2 scaling test
    # VRP-Alt weight: 7.5%
    name: core_v6_trend_csmom_vrp_core_convergence_vrp_alt_7p5_no_macro
    display_name: "Core v6 + VRP-Alt (7.5%)"
    description: "Trend + CSMOM + VRP-Core + VRP-Convergence + VRP-Alt (7.5%); no macro overlays"
    is_baseline: false
    status: "phase2_scaling_test"
    strategies:
      tsmom_multihorizon:
        enabled: true
        weight: 0.5875  # Reduced by 3.75% to fund VRP-Alt
        params:
          horizon_weights:
            long_252: 0.50
            med_84: 0.30
            short_21: 0.20
          feature_weights:
            long:
              ret_252: 0.5
              breakout_252: 0.3
              slope_slow: 0.2
            med:
              ret_84: 0.4
              breakout_126: 0.3
              slope_med: 0.2
              persistence: 0.1
            short:
              ret_21: 0.5
              breakout_21: 0.3
              slope_fast: 0.2
              reversal: 0.0
          signal_cap: 3.0
          rebalance: "W-FRI"
          vol_normalization:
            enabled: true
            halflife_days: 63
            sigma_floor_annual: 0.05
            risk_scale: 0.2
      csmom_meta:
        enabled: true
        weight: 0.25  # Unchanged
        params:
          lookbacks: [63, 126, 252]
          horizon_weights: [0.4, 0.35, 0.25]
          vol_lookback: 63
          rebalance: "D"
          neutralize_cross_section: true
          clip: 3.0
      vrp_core_meta:
        enabled: true
        weight: 0.075  # Unchanged
        params:
          rv_lookback: 21
          zscore_window: 252
          clip: 3.0
          signal_mode: "zscore"
      vrp_convergence_meta:
        enabled: true
        weight: 0.0125  # Reduced from 2.5% to 1.25%
        params:
          zscore_window: 252
          clip: 3.0
          signal_mode: "zscore"
          target_vol: 0.10
          vol_lookback: 63
          vol_floor: 0.05
      vrp_alt_meta:
        enabled: true
        weight: 0.075  # 7.5% weight
        params:
          zscore_window: 252
          clip: 3.0
          signal_mode: "zscore"
          target_vol: 0.10
          vol_lookback: 63
          vol_floor: 0.05
      tsmom:
        enabled: false
        weight: 0.0
      tsmom_med:
        enabled: false
        weight: 0.0
      tsmom_short:
        enabled: false
        weight: 0.0
      sr3_carry_curve:
        enabled: false
        weight: 0.0
      rates_curve:
        enabled: false
        weight: 0.0
      fx_commod_carry:
        enabled: false
        weight: 0.0
    macro_regime:
      enabled: false

  core_v6_trend_csmom_vrp_core_convergence_vrp_alt_10_no_macro:
    # Core v6 + VRP-Alt (10%): Phase-2 scaling test
    # VRP-Alt weight: 10%
    name: core_v6_trend_csmom_vrp_core_convergence_vrp_alt_10_no_macro
    display_name: "Core v6 + VRP-Alt (10%)"
    description: "Trend + CSMOM + VRP-Core + VRP-Convergence + VRP-Alt (10%); no macro overlays"
    is_baseline: false
    status: "phase2_scaling_test"
    strategies:
      tsmom_multihorizon:
        enabled: true
        weight: 0.575  # Reduced by 5% to fund VRP-Alt
        params:
          horizon_weights:
            long_252: 0.50
            med_84: 0.30
            short_21: 0.20
          feature_weights:
            long:
              ret_252: 0.5
              breakout_252: 0.3
              slope_slow: 0.2
            med:
              ret_84: 0.4
              breakout_126: 0.3
              slope_med: 0.2
              persistence: 0.1
            short:
              ret_21: 0.5
              breakout_21: 0.3
              slope_fast: 0.2
              reversal: 0.0
          signal_cap: 3.0
          rebalance: "W-FRI"
          vol_normalization:
            enabled: true
            halflife_days: 63
            sigma_floor_annual: 0.05
            risk_scale: 0.2
      csmom_meta:
        enabled: true
        weight: 0.25  # Unchanged
        params:
          lookbacks: [63, 126, 252]
          horizon_weights: [0.4, 0.35, 0.25]
          vol_lookback: 63
          rebalance: "D"
          neutralize_cross_section: true
          clip: 3.0
      vrp_core_meta:
        enabled: true
        weight: 0.075  # Unchanged
        params:
          rv_lookback: 21
          zscore_window: 252
          clip: 3.0
          signal_mode: "zscore"
      vrp_convergence_meta:
        enabled: true
        weight: 0.0  # Disabled to fund VRP-Alt
        params:
          zscore_window: 252
          clip: 3.0
          signal_mode: "zscore"
          target_vol: 0.10
          vol_lookback: 63
          vol_floor: 0.05
      vrp_alt_meta:
        enabled: true
        weight: 0.10  # 10% weight
        params:
          zscore_window: 252
          clip: 3.0
          signal_mode: "zscore"
          target_vol: 0.10
          vol_lookback: 63
          vol_floor: 0.05
      tsmom:
        enabled: false
        weight: 0.0
      tsmom_med:
        enabled: false
        weight: 0.0
      tsmom_short:
        enabled: false
        weight: 0.0
      sr3_carry_curve:
        enabled: false
        weight: 0.0
      rates_curve:
        enabled: false
        weight: 0.0
      fx_commod_carry:
        enabled: false
        weight: 0.0
    macro_regime:
      enabled: false

  core_v6_trend_csmom_vrp_core_convergence_vrp_alt_15_no_macro:
    # Core v6 + VRP-Alt (15%): Phase-2 scaling test
    # VRP-Alt weight: 15%
    name: core_v6_trend_csmom_vrp_core_convergence_vrp_alt_15_no_macro
    display_name: "Core v6 + VRP-Alt (15%)"
    description: "Trend + CSMOM + VRP-Core + VRP-Convergence + VRP-Alt (15%); no macro overlays"
    is_baseline: false
    status: "phase2_scaling_test"
    strategies:
      tsmom_multihorizon:
        enabled: true
        weight: 0.55  # Reduced by 7.5% to fund VRP-Alt
        params:
          horizon_weights:
            long_252: 0.50
            med_84: 0.30
            short_21: 0.20
          feature_weights:
            long:
              ret_252: 0.5
              breakout_252: 0.3
              slope_slow: 0.2
            med:
              ret_84: 0.4
              breakout_126: 0.3
              slope_med: 0.2
              persistence: 0.1
            short:
              ret_21: 0.5
              breakout_21: 0.3
              slope_fast: 0.2
              reversal: 0.0
          signal_cap: 3.0
          rebalance: "W-FRI"
          vol_normalization:
            enabled: true
            halflife_days: 63
            sigma_floor_annual: 0.05
            risk_scale: 0.2
      csmom_meta:
        enabled: true
        weight: 0.25  # Unchanged
        params:
          lookbacks: [63, 126, 252]
          horizon_weights: [0.4, 0.35, 0.25]
          vol_lookback: 63
          rebalance: "D"
          neutralize_cross_section: true
          clip: 3.0
      vrp_core_meta:
        enabled: true
        weight: 0.075  # Unchanged
        params:
          rv_lookback: 21
          zscore_window: 252
          clip: 3.0
          signal_mode: "zscore"
      vrp_convergence_meta:
        enabled: true
        weight: 0.0  # Disabled to fund VRP-Alt
        params:
          zscore_window: 252
          clip: 3.0
          signal_mode: "zscore"
          target_vol: 0.10
          vol_lookback: 63
          vol_floor: 0.05
      vrp_alt_meta:
        enabled: true
        weight: 0.15  # 15% weight
        params:
          zscore_window: 252
          clip: 3.0
          signal_mode: "zscore"
          target_vol: 0.10
          vol_lookback: 63
          vol_floor: 0.05
      tsmom:
        enabled: false
        weight: 0.0
      tsmom_med:
        enabled: false
        weight: 0.0
      tsmom_short:
        enabled: false
        weight: 0.0
      sr3_carry_curve:
        enabled: false
        weight: 0.0
      rates_curve:
        enabled: false
        weight: 0.0
      fx_commod_carry:
        enabled: false
        weight: 0.0
    macro_regime:
      enabled: false

  core_v3_trend_breakout:
    # Experimental: Trend Meta-Sleeve with Breakout Mid (50-100d) as 5th atomic sleeve
    # Phase-1 integration: Breakout Mid added as internal atomic sleeve
    # Proposed horizon weights: long=0.45, med=0.28, short=0.20, residual=0.15, breakout_mid=0.10
    strategies:
      tsmom_multihorizon:
        enabled: true
        weight: 1.0  # Full weight on Trend Meta-Sleeve (breakout included internally)
        params:
          horizon_weights:
            long_252: 0.45      # Reduced from 0.50 to make room for breakout
            med_84: 0.28        # Reduced from 0.30
            short_21: 0.20      # Unchanged
            residual_252_21: 0.07  # Reduced from 0.15 to make room for breakout
            breakout_mid_50_100: 0.10  # NEW: Breakout mid as 5th atomic sleeve
          feature_weights:
            long:
              ret_252: 0.5
              breakout_252: 0.3
              slope_slow: 0.2
            med:
              ret_84: 0.4
              breakout_126: 0.3
              slope_med: 0.2
              persistence: 0.1
            short:
              ret_21: 0.5
              breakout_21: 0.3
              slope_fast: 0.2
              reversal: 0.0
            breakout_mid_50_100:
              breakout_50: 0.5
              breakout_100: 0.5
          signal_cap: 3.0
          rebalance: "W-FRI"
          vol_normalization:
            enabled: true
            halflife_days: 63
            sigma_floor_annual: 0.05
            risk_scale: 0.2
      tsmom:
        enabled: false
        weight: 0.0
      tsmom_med:
        enabled: false
        weight: 0.0
      tsmom_short:
        enabled: false
        weight: 0.0
      sr3_carry_curve:
        enabled: false
        weight: 0.0
      rates_curve:
        enabled: false
        weight: 0.0
      fx_commod_carry:
        enabled: false
        weight: 0.0
      csmom_meta:
        enabled: false
        weight: 0.0
      residual_trend:
        enabled: false
        weight: 0.0
      persistence:
        enabled: false
        weight: 0.0
    macro_regime:
      enabled: false  # Disable macro overlay for baseline

  # Phase-1B: Breakout Mid Refinement Tests
  # Testing lower weight (3%) and different feature weight schemes
  core_v3_trend_breakout_1b_7030:
    # Phase-1B Test 1: Breakout weight 3%, feature weights 70/30 (50d/100d)
    strategies:
      tsmom_multihorizon:
        enabled: true
        weight: 1.0
        params:
          horizon_weights:
            long_252: 0.485     # Adjusted from 0.50 to accommodate 3% breakout (0.50 * 0.97)
            med_84: 0.291        # Adjusted from 0.30 (0.30 * 0.97)
            short_21: 0.194      # Adjusted from 0.20 (0.20 * 0.97)
            breakout_mid_50_100: 0.03  # Phase-1B: 3% weight
          feature_weights:
            long:
              ret_252: 0.5
              breakout_252: 0.3
              slope_slow: 0.2
            med:
              ret_84: 0.4
              breakout_126: 0.3
              slope_med: 0.2
              persistence: 0.1
            short:
              ret_21: 0.5
              breakout_21: 0.3
              slope_fast: 0.2
              reversal: 0.0
            breakout_mid_50_100:
              breakout_50: 0.7   # Phase-1B: 70% weight on 50d
              breakout_100: 0.3   # Phase-1B: 30% weight on 100d
          signal_cap: 3.0
          rebalance: "W-FRI"
          vol_normalization:
            enabled: true
            halflife_days: 63
            sigma_floor_annual: 0.05
            risk_scale: 0.2
      tsmom:
        enabled: false
        weight: 0.0
      tsmom_med:
        enabled: false
        weight: 0.0
      tsmom_short:
        enabled: false
        weight: 0.0
      sr3_carry_curve:
        enabled: false
        weight: 0.0
      rates_curve:
        enabled: false
        weight: 0.0
      fx_commod_carry:
        enabled: false
        weight: 0.0
      csmom_meta:
        enabled: false
        weight: 0.0
      residual_trend:
        enabled: false
        weight: 0.0
      persistence:
        enabled: false
        weight: 0.0
    macro_regime:
      enabled: false

  core_v3_trend_breakout_1b_3070:
    # Phase-1B Test 2: Breakout weight 3%, feature weights 30/70 (50d/100d)
    strategies:
      tsmom_multihorizon:
        enabled: true
        weight: 1.0
        params:
          horizon_weights:
            long_252: 0.47
            med_84: 0.29
            short_21: 0.20
            residual_252_21: 0.01
            breakout_mid_50_100: 0.03  # Phase-1B: 3%
          feature_weights:
            long:
              ret_252: 0.5
              breakout_252: 0.3
              slope_slow: 0.2
            med:
              ret_84: 0.4
              breakout_126: 0.3
              slope_med: 0.2
              persistence: 0.1
            short:
              ret_21: 0.5
              breakout_21: 0.3
              slope_fast: 0.2
              reversal: 0.0
            breakout_mid_50_100:
              breakout_50: 0.3   # Phase-1B: 30% weight on 50d
              breakout_100: 0.7  # Phase-1B: 70% weight on 100d
          signal_cap: 3.0
          rebalance: "W-FRI"
          vol_normalization:
            enabled: true
            halflife_days: 63
            sigma_floor_annual: 0.05
            risk_scale: 0.2
      tsmom:
        enabled: false
        weight: 0.0
      tsmom_med:
        enabled: false
        weight: 0.0
      tsmom_short:
        enabled: false
        weight: 0.0
      sr3_carry_curve:
        enabled: false
        weight: 0.0
      rates_curve:
        enabled: false
        weight: 0.0
      fx_commod_carry:
        enabled: false
        weight: 0.0
      csmom_meta:
        enabled: false
        weight: 0.0
      residual_trend:
        enabled: false
        weight: 0.0
      persistence:
        enabled: false
        weight: 0.0
    macro_regime:
      enabled: false

  core_v3_trend_breakout_1b_1000:
    # Phase-1B Test 3: Breakout weight 3%, pure 50d (100/0)
    strategies:
      tsmom_multihorizon:
        enabled: true
        weight: 1.0
        params:
          horizon_weights:
            long_252: 0.47
            med_84: 0.29
            short_21: 0.20
            residual_252_21: 0.01
            breakout_mid_50_100: 0.03  # Phase-1B: 3%
          feature_weights:
            long:
              ret_252: 0.5
              breakout_252: 0.3
              slope_slow: 0.2
            med:
              ret_84: 0.4
              breakout_126: 0.3
              slope_med: 0.2
              persistence: 0.1
            short:
              ret_21: 0.5
              breakout_21: 0.3
              slope_fast: 0.2
              reversal: 0.0
            breakout_mid_50_100:
              breakout_50: 1.0   # Phase-1B: Pure 50d breakout
              breakout_100: 0.0
          signal_cap: 3.0
          rebalance: "W-FRI"
          vol_normalization:
            enabled: true
            halflife_days: 63
            sigma_floor_annual: 0.05
            risk_scale: 0.2
      tsmom:
        enabled: false
        weight: 0.0
      tsmom_med:
        enabled: false
        weight: 0.0
      tsmom_short:
        enabled: false
        weight: 0.0
      sr3_carry_curve:
        enabled: false
        weight: 0.0
      rates_curve:
        enabled: false
        weight: 0.0
      fx_commod_carry:
        enabled: false
        weight: 0.0
      csmom_meta:
        enabled: false
        weight: 0.0
      residual_trend:
        enabled: false
        weight: 0.0
      persistence:
        enabled: false
        weight: 0.0
    macro_regime:
      enabled: false

  core_v3_trend_breakout_1b_0100:
    # Phase-1B Test 4: Breakout weight 3%, pure 100d (0/100)
    strategies:
      tsmom_multihorizon:
        enabled: true
        weight: 1.0
        params:
          horizon_weights:
            long_252: 0.47
            med_84: 0.29
            short_21: 0.20
            residual_252_21: 0.01
            breakout_mid_50_100: 0.03  # Phase-1B: 3%
          feature_weights:
            long:
              ret_252: 0.5
              breakout_252: 0.3
              slope_slow: 0.2
            med:
              ret_84: 0.4
              breakout_126: 0.3
              slope_med: 0.2
              persistence: 0.1
            short:
              ret_21: 0.5
              breakout_21: 0.3
              slope_fast: 0.2
              reversal: 0.0
            breakout_mid_50_100:
              breakout_50: 0.0
              breakout_100: 1.0   # Phase-1B: Pure 100d breakout
          signal_cap: 3.0
          rebalance: "W-FRI"
          vol_normalization:
            enabled: true
            halflife_days: 63
            sigma_floor_annual: 0.05
            risk_scale: 0.2
      tsmom:
        enabled: false
        weight: 0.0
      tsmom_med:
        enabled: false
        weight: 0.0
      tsmom_short:
        enabled: false
        weight: 0.0
      sr3_carry_curve:
        enabled: false
        weight: 0.0
      rates_curve:
        enabled: false
        weight: 0.0
      fx_commod_carry:
        enabled: false
        weight: 0.0
      csmom_meta:
        enabled: false
        weight: 0.0
      residual_trend:
        enabled: false
        weight: 0.0
      persistence:
        enabled: false
        weight: 0.0
    macro_regime:
      enabled: false

  core_v3_trend_breakout_70_30_phase2:
    # Phase-2: Breakout Mid (50-100d) with winning Phase-1B configuration
    # Configuration: 3% horizon weight, 70% breakout_50, 30% breakout_100
    strategies:
      tsmom_multihorizon:
        enabled: true
        weight: 1.0
        params:
          horizon_weights:
            long_252: 0.485     # Adjusted from 0.50 to accommodate 3% breakout
            med_84: 0.291       # Adjusted from 0.30
            short_21: 0.194      # Adjusted from 0.20
            breakout_mid_50_100: 0.03  # Phase-2: 3% weight (Phase-1B winner)
          feature_weights:
            long:
              ret_252: 0.5
              breakout_252: 0.3
              slope_slow: 0.2
            med:
              ret_84: 0.4
              breakout_126: 0.3
              slope_med: 0.2
              persistence: 0.1
            short:
              ret_21: 0.5
              breakout_21: 0.3
              slope_fast: 0.2
              reversal: 0.0
            breakout_mid_50_100:
              breakout_50: 0.7   # Phase-2: 70% weight on 50d (Phase-1B winner)
              breakout_100: 0.3  # Phase-2: 30% weight on 100d
          signal_cap: 3.0
          rebalance: "W-FRI"
          vol_normalization:
            enabled: true
            halflife_days: 63
            sigma_floor_annual: 0.05
            risk_scale: 0.2
      tsmom:
        enabled: false
        weight: 0.0
      tsmom_med:
        enabled: false
        weight: 0.0
      tsmom_short:
        enabled: false
        weight: 0.0
      sr3_carry_curve:
        enabled: false
        weight: 0.0
      rates_curve:
        enabled: false
        weight: 0.0
      fx_commod_carry:
        enabled: false
        weight: 0.0
      csmom_meta:
        enabled: false
        weight: 0.0
      residual_trend:
        enabled: false
        weight: 0.0
      persistence:
        enabled: false
        weight: 0.0
    macro_regime:
      enabled: false

  medium_canonical_phase1:
    # Phase-1: Canonical Medium-Term (84d) Standalone Atomic Sleeve
    # Validates the canonical medium-term sleeve independently before Phase-2 integration
    # Uses equal-weight composite (1/3, 1/3, 1/3):
    #   - 84d return momentum (skip 10d, vol-scaled with 21d vol, z-scored)
    #   - 84d breakout strength (z-scored)
    #   - EMA21 vs EMA84 slope (vol-scaled with 21d vol, z-scored)
    strategies:
      tsmom_med_canonical:
        enabled: true
        weight: 1.0
        params:
          signal_cap: 3.0
          rebalance: "W-FRI"
      tsmom_multihorizon:
        enabled: false
        weight: 0.0
      tsmom:
        enabled: false
        weight: 0.0
      tsmom_med:
        enabled: false
        weight: 0.0
      tsmom_short:
        enabled: false
        weight: 0.0
      sr3_carry_curve:
        enabled: false
        weight: 0.0
      rates_curve:
        enabled: false
        weight: 0.0
      fx_commod_carry:
        enabled: false
        weight: 0.0
      csmom_meta:
        enabled: false
        weight: 0.0
      residual_trend:
        enabled: false
        weight: 0.0
      persistence:
        enabled: false
        weight: 0.0
    macro_regime:
      enabled: false  # Disable macro overlay for baseline
  
  medium_legacy_phase1:
    # Phase-1: Legacy Medium-Term Standalone (for comparison)
    # Uses the legacy medium-term sleeve (84d/126d, persistence, 0.4/0.3/0.2/0.1)
    strategies:
      tsmom_med:
        enabled: true
        weight: 1.0
        params:
          weights:
            ret_84: 0.4
            breakout_126: 0.3
            slope_med: 0.2
            persistence: 0.1
          signal_cap: 3.0
          rebalance: "W-FRI"
      tsmom_multihorizon:
        enabled: false
        weight: 0.0
      tsmom:
        enabled: false
        weight: 0.0
      tsmom_short:
        enabled: false
        weight: 0.0
      sr3_carry_curve:
        enabled: false
        weight: 0.0
      rates_curve:
        enabled: false
        weight: 0.0
      fx_commod_carry:
        enabled: false
        weight: 0.0
      csmom_meta:
        enabled: false
        weight: 0.0
      residual_trend:
        enabled: false
        weight: 0.0
      persistence:
        enabled: false
        weight: 0.0
    macro_regime:
      enabled: false  # Disable macro overlay for baseline
  
  core_v3_trend_medcanon_no_macro:
    # Phase-2: Trend Meta-Sleeve with Canonical Medium-Term variant
    # Tests canonical medium-term sleeve integrated into Trend Meta-Sleeve
    # This is a clean A/B test vs core_v3_no_macro (which uses legacy medium-term)
    strategies:
      tsmom_multihorizon:
        enabled: true
        weight: 1.0
        params:
          horizon_weights:
            long_252: 0.485
            med_84: 0.291
            short_21: 0.194
            breakout_mid_50_100: 0.03
          feature_weights:
            long:
              ret_252: 0.333333    # Canonical long-term (1/3 each)
              breakout_252: 0.333333
              slope_slow: 0.333334
            med:
              # NOTE: This will use canonical medium-term features internally
              # Implementation in TSMOMMultiHorizon needs to support "medium_variant: canonical"
              ret_84: 0.333333      # Canonical medium-term (1/3 each)
              breakout_84: 0.333333  # Note: using 84d breakout (not 126d)
              slope_21_84: 0.333334  # Note: using EMA21-84 slope
              persistence: 0.0       # Disabled in canonical version
            short:
              ret_21: 0.5
              breakout_21: 0.3
              slope_fast: 0.2
              reversal: 0.0
            breakout_mid_50_100:
              breakout_50: 0.7
              breakout_100: 0.3
          signal_cap: 3.0
          rebalance: "W-FRI"
          vol_normalization:
            enabled: true
            halflife_days: 63
            sigma_floor_annual: 0.05
            risk_scale: 0.2
          # NEW: Medium-term variant selector
          medium_variant: "canonical"  # Options: "legacy" (default), "canonical"
      tsmom:
        enabled: false
        weight: 0.0
      tsmom_med:
        enabled: false
        weight: 0.0
      tsmom_short:
        enabled: false
        weight: 0.0
      sr3_carry_curve:
        enabled: false
        weight: 0.0
      rates_curve:
        enabled: false
        weight: 0.0
      fx_commod_carry:
        enabled: false
        weight: 0.0
      csmom_meta:
        enabled: false
        weight: 0.0
      residual_trend:
        enabled: false
        weight: 0.0
      persistence:
        enabled: false
        weight: 0.0
    macro_regime:
      enabled: false  # Disable macro overlay for baseline
  
  core_v3_trend_shortcanon_no_macro:
    # Phase-2: Trend Meta-Sleeve with Canonical Short-Term variant
    # Tests canonical short-term sleeve (equal-weight 1/3, 1/3, 1/3) integrated into Trend Meta-Sleeve
    # This is a clean A/B test vs core_v3_no_macro (which uses legacy short-term)
    strategies:
      tsmom_multihorizon:
        enabled: true
        weight: 1.0
        params:
          horizon_weights:
            long_252: 0.485
            med_84: 0.291
            short_21: 0.194
            breakout_mid_50_100: 0.03
          feature_weights:
            long:
              ret_252: 0.333333       # Canonical (1/3) - Promoted Nov 2025
              breakout_252: 0.333333  # Canonical (1/3) - Promoted Nov 2025
              slope_slow: 0.333334    # Canonical (1/3) - Promoted Nov 2025
            med:
              # Canonical medium-term (1/3 each) - Promoted Nov 2025
              ret_84: 0.333333        # Canonical (1/3) - Promoted Nov 2025
              breakout_84: 0.333333   # Canonical (1/3) - Promoted Nov 2025
              slope_21_84: 0.333334   # Canonical (1/3) - Promoted Nov 2025
              persistence: 0.0        # Disabled in canonical version
            short:
              # Canonical short-term (1/3 each) - Phase-2 testing Nov 2025
              ret_21: 0.333333        # Canonical (1/3) - Phase-2
              breakout_21: 0.333333   # Canonical (1/3) - Phase-2
              slope_fast: 0.333334    # Canonical (1/3) - Phase-2
              reversal: 0.0           # Not used (weight 0)
            breakout_mid_50_100:
              breakout_50: 0.7
              breakout_100: 0.3
          signal_cap: 3.0
          rebalance: "W-FRI"
          vol_normalization:
            enabled: true
            halflife_days: 63
            sigma_floor_annual: 0.05
            risk_scale: 0.2
          # Medium-term and short-term variant selectors
          medium_variant: "canonical"  # Promoted to production Nov 2025
          short_variant: "canonical"   # Phase-2 testing: canonical short-term
      tsmom:
        enabled: false
        weight: 0.0
      tsmom_med:
        enabled: false
        weight: 0.0
      tsmom_short:
        enabled: false
        weight: 0.0
      sr3_carry_curve:
        enabled: false
        weight: 0.0
      rates_curve:
        enabled: false
        weight: 0.0
      fx_commod_carry:
        enabled: false
        weight: 0.0
      csmom_meta:
        enabled: false
        weight: 0.0
      residual_trend:
        enabled: false
        weight: 0.0
    macro_regime:
      enabled: false  # Disable macro overlay for baseline
  
  short_canonical_phase1:
    # Phase-1: Canonical Short-Term (21d) Standalone Atomic Sleeve
    # Validates the canonical short-term sleeve independently before Phase-2 integration
    # Uses equal-weight composite (1/3, 1/3, 1/3):
    #   - 21d return momentum (skip 5d, vol-scaled with 20d vol, z-scored)
    #   - 21d breakout strength (z-scored)
    #   - Fast slope: EMA10 vs EMA40 (vol-scaled with 20d vol, z-scored)
    strategies:
      tsmom_short:
        enabled: true
        weight: 1.0
        params:
          weights:
            ret_21: 0.333333        # Canonical (1/3) - Phase-1
            breakout_21: 0.333333   # Canonical (1/3) - Phase-1
            slope_fast: 0.333334    # Canonical (1/3) - Phase-1
            reversal_filter: 0.0    # Not used (weight 0)
          signal_cap: 3.0
          rebalance: "W-FRI"
          variant: "canonical"  # Canonical short-term variant
      tsmom_multihorizon:
        enabled: false
        weight: 0.0
      tsmom:
        enabled: false
        weight: 0.0
      tsmom_med:
        enabled: false
        weight: 0.0
      sr3_carry_curve:
        enabled: false
        weight: 0.0
      rates_curve:
        enabled: false
        weight: 0.0
      fx_commod_carry:
        enabled: false
        weight: 0.0
      csmom_meta:
        enabled: false
        weight: 0.0
      residual_trend:
        enabled: false
        weight: 0.0
      persistence:
        enabled: false
        weight: 0.0
    macro_regime:
      enabled: false  # Disable macro overlay for baseline
  
  short_legacy_phase1:
    # Phase-1: Legacy Short-Term Standalone (for comparison)
    # Uses the legacy short-term sleeve (21d, weights 0.5, 0.3, 0.2)
    strategies:
      tsmom_short:
        enabled: true
        weight: 1.0
        params:
          weights:
            ret_21: 0.5             # Legacy weighting
            breakout_21: 0.3        # Legacy weighting
            slope_fast: 0.2         # Legacy weighting
            reversal_filter: 0.0    # Not used
          signal_cap: 3.0
          rebalance: "W-FRI"
          variant: "legacy"  # Legacy short-term variant
      tsmom_multihorizon:
        enabled: false
        weight: 0.0
      tsmom:
        enabled: false
        weight: 0.0
      tsmom_med:
        enabled: false
        weight: 0.0
      sr3_carry_curve:
        enabled: false
        weight: 0.0
      rates_curve:
        enabled: false
        weight: 0.0
      fx_commod_carry:
        enabled: false
        weight: 0.0
      csmom_meta:
        enabled: false
        weight: 0.0
      residual_trend:
        enabled: false
        weight: 0.0
      persistence:
        enabled: false
        weight: 0.0
    macro_regime:
      enabled: false  # Disable macro overlay for baseline
  
  core_v3_trend_long_canonical:
    # Phase-1: Canonical Long-Term Trend Sleeve (TSMOM-252)
    # Formalizes the long-term 252d horizon as a clean atomic sleeve
    # with academically grounded equal-weight composite:
    # long_trend_score = (1/3) * ret_252 + (1/3) * breakout_252 + (1/3) * slope_slow
    # This replaces the legacy (0.5, 0.3, 0.2) weighting with a canonical (1/3, 1/3, 1/3) approach
    strategies:
      tsmom_multihorizon:
        enabled: true
        weight: 1.0
        params:
          horizon_weights:
            long_252: 0.485     # Same horizon weight as core_v3_no_macro
            med_84: 0.291
            short_21: 0.194
            breakout_mid_50_100: 0.03
          feature_weights:
            long:
              ret_252: 0.333333    # Phase-1: Equal weighting (1/3 each)
              breakout_252: 0.333333
              slope_slow: 0.333334  # Sum to exactly 1.0
            med:
              ret_84: 0.4
              breakout_126: 0.3
              slope_med: 0.2
              persistence: 0.1
            short:
              ret_21: 0.5
              breakout_21: 0.3
              slope_fast: 0.2
              reversal: 0.0
            breakout_mid_50_100:
              breakout_50: 0.7
              breakout_100: 0.3
          signal_cap: 3.0
          rebalance: "W-FRI"
          vol_normalization:
            enabled: true
            halflife_days: 63
            sigma_floor_annual: 0.05
            risk_scale: 0.2
      tsmom:
        enabled: false
        weight: 0.0
      tsmom_med:
        enabled: false
        weight: 0.0
      tsmom_short:
        enabled: false
        weight: 0.0
      sr3_carry_curve:
        enabled: false
        weight: 0.0
      rates_curve:
        enabled: false
        weight: 0.0
      fx_commod_carry:
        enabled: false
        weight: 0.0
      csmom_meta:
        enabled: false
        weight: 0.0
      residual_trend:
        enabled: false
        weight: 0.0
      persistence:
        enabled: false
        weight: 0.0
    macro_regime:
      enabled: false  # Disable macro overlay for baseline

  momentum_long_fxcarry_rates_v1:
    # Momentum + FX/Commodity Carry + Rates Curve: Long-term TSMOM + FX/Commodity carry + Rates curve
    # Tests whether adding rates curve signals improves or degrades performance
    strategies:
      tsmom:
        enabled: true
        weight: 1.0
        params:
          weights:
            ret_252: 0.5
            breakout_252: 0.3
            slope_slow: 0.2
          signal_cap: 3.0
          rebalance: "W-FRI"
      tsmom_med:
        enabled: false
        weight: 0.0
      tsmom_short:
        enabled: false
        weight: 0.0
      sr3_carry_curve:
        enabled: false
        weight: 0.0
      rates_curve:
        enabled: true
        weight: 1.0
        params:
          z_cap: 3.0
          w_slope_2s10s: 0.35
          w_slope_5s30s: 0.35
          w_curv_2s5s10s: 0.15
          w_curv_5s10s30s: 0.15
          sym_2y: "ZT_FRONT_VOLUME"
          sym_5y: "ZF_FRONT_VOLUME"
          sym_10y: "ZN_FRONT_VOLUME"
          sym_30y: "UB_FRONT_VOLUME"
      fx_commod_carry:
        enabled: true
        weight: 1.0
        params:
          w_ts: 0.6
          w_xs: 0.25
          w_mom: 0.15
          clip: 3.0
          roots: ["CL", "GC", "6E", "6B", "6J"]
          window: 252
    macro_regime:
      enabled: false  # Disable macro overlay for baseline

  core_v1:
    # Core v1: Long-term momentum + FX/Commodity carry only
    # Clean two-sleeve architecture for stable performance
    strategies:
      tsmom:
        enabled: true
        weight: 1.0
        params:
          weights:
            ret_252: 0.5
            breakout_252: 0.3
            slope_slow: 0.2
          signal_cap: 3.0
          rebalance: "W-FRI"
      tsmom_med:
        enabled: false
        weight: 0.0
      tsmom_short:
        enabled: false
        weight: 0.0
      sr3_carry_curve:
        enabled: false
        weight: 0.0
      rates_curve:
        enabled: false
        weight: 0.0
      fx_commod_carry:
        enabled: true
        weight: 1.0
        params:
          w_ts: 0.6
          w_xs: 0.25
          w_mom: 0.15
          clip: 3.0
          roots: ["CL", "GC", "6E", "6B", "6J"]
          window: 252
    macro_regime:
      enabled: false  # Macro overlay OFF for core_v1 baseline

  core_v1_with_macro:
    # Core v1 with Macro Overlay: Long-term momentum + FX/Commodity carry + Macro regime filter
    # Tests whether macro overlay reduces drawdowns without wrecking returns
    strategies:
      tsmom:
        enabled: true
        weight: 1.0
        params:
          weights:
            ret_252: 0.5
            breakout_252: 0.3
            slope_slow: 0.2
          signal_cap: 3.0
          rebalance: "W-FRI"
      tsmom_med:
        enabled: false
        weight: 0.0
      tsmom_short:
        enabled: false
        weight: 0.0
      sr3_carry_curve:
        enabled: false
        weight: 0.0
      rates_curve:
        enabled: false
        weight: 0.0
      fx_commod_carry:
        enabled: true
        weight: 1.0
        params:
          w_ts: 0.6
          w_xs: 0.25
          w_mom: 0.15
          clip: 3.0
          roots: ["CL", "GC", "6E", "6B", "6J"]
          window: 252
    macro_regime:
      enabled: true  # Macro overlay ON for core_v1_with_macro

# Feature service configuration
features:
  sr3_curve:
    root: "SR3"
    ranks: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]  # 12 ranks
    window: 252  # Rolling window for z-score standardization
  residual_trend:
    long_lookback: 252  # Long-horizon lookback period
    short_lookback: 21  # Short-horizon lookback period
    clip: 3.0  # Z-score clipping bounds for cross-sectional z-scoring
  persistence:
    acceleration_window: 21  # Window for acceleration calculation (default: 21 days)
    clip: 3.0  # Z-score clipping bounds for cross-sectional z-scoring
  
  rates_curve:
    dv01_config_path: "configs/rates_dv01.yaml"  # Path to DV01 config
    window: 252  # Rolling window for z-score standardization
    anchor_lag_days: 2  # FRED anchor lag (business days). Use 0 for backtests, 2-3 for live
  
  fx_commod_carry:
    roots: ["CL", "GC", "6E", "6B", "6J"]  # Roots for carry features
    window: 252  # Rolling window for z-score standardization
    clip: 3.0    # Z-score clipping bounds
  
  long_momentum:
    lookback: 252      # Lookback period for return calculation (days)
    skip_recent: 21    # Days to skip at the end (the "-1 month" gap)
    vol_window: 63     # Window for volatility calculation (days)
    window: 252        # Rolling window for z-score standardization (days)
    clip: 3.0          # Z-score clipping bounds
  
  medium_momentum:
    lookback: 84       # Lookback period for return calculation (days)
    skip_recent: 10    # Days to skip at the end
    vol_window: 63     # Window for volatility calculation (days)
    window: 252        # Rolling window for z-score standardization (days)
    clip: 3.0          # Z-score clipping bounds
  
  canonical_medium_momentum:
    lookback: 84       # Lookback period for return calculation (days) - canonical
    skip_recent: 10    # Days to skip at the end - canonical
    vol_window: 21     # Window for volatility calculation (days) - canonical: 21-day vol
    window: 252        # Rolling window for z-score standardization (days)
    clip: 3.0          # Z-score clipping bounds
  
  short_momentum:
    lookback: 21       # Lookback period for return calculation (days)
    skip_recent: 5    # Days to skip at the end
    vol_window: 20     # Window for volatility calculation (days)
    window: 252        # Rolling window for z-score standardization (days)
    clip: 3.0          # Z-score clipping bounds

